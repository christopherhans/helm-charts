kind: ConfigMap
apiVersion: v1
metadata:
  name: elastiflow-nginx-proxy-conf
  labels:
    app: "{{ template "logstash.fullname" . }}-nginx"
    chart: "{{ .Chart.Name }}"
    heritage: {{ .Release.Service | quote }}
    release: {{ .Release.Name | quote }}
data:
  nginx.conf: |
    user nginx;
    worker_processes  5;
    error_log  /dev/stdout info;
    events {
      worker_connections  10240;
    }

    stream {
      server {
        listen 2057 proxy_protocol;
        proxy_pass localhost:2055;
        proxy_responses 0;
        proxy_buffer_size 16384k;
        proxy_bind $proxy_protocol_addr transparent;
      }
    }

